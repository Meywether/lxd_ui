webpackJsonp([24],{"31LQ":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-snackbar",{attrs:{top:"",timeout:e.snackbarTimeout,color:e.snackbarColor},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n    "+e._s(e.snackbarText)+"\n    "),n("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){e.snackbar=!1}}},[e._v("Close")])],1),n("v-content",[n("v-container",{attrs:{fluid:"",tag:"section",id:"grid"}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{"d-flex":"",xs12:"","order-xs5":""}},[n("v-layout",{attrs:{column:""}},[n("v-flex",{staticClass:"display mb-2",attrs:{tag:"h1"}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"",sm6:""}},[e._v("\n                  API - Data\n                ")]),n("v-flex",{attrs:{xs12:"",sm6:""}},[n("v-btn",{staticStyle:{float:"right"},attrs:{small:"",color:"success"},on:{click:function(t){e.dialog=!0}}},[e._v("New Endpoint")])],1)],1)],1),n("v-flex",[n("v-alert",{attrs:{type:"error",value:e.error}},[e._v("\n                "+e._s(e.error)+"\n              ")]),n("p",[e._v("The data API allows you to create custom data endpoints on the server.")]),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.tableHeaders,items:e.items,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(n){n.stopPropagation(),e.editItem(t.item)}}},[e._v(e._s(t.item.module))])]),n("td",[e._v(e._s(t.item.version))]),n("td",[n("v-btn",{staticClass:"mx-0",staticStyle:{float:"right"},attrs:{icon:""},on:{click:function(n){e.deleteItem(t.item)}}},[n("v-icon",{attrs:{color:"pink"}},[e._v("delete")])],1)],1)]}}])},[n("template",{slot:"no-data"},[e._v("\n                  You have not added any API endpoints.\n                ")])],2)],1)],1)],1)],1)],1),n("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",scrollable:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",{attrs:{tile:""}},[n("v-toolbar",{attrs:{card:"",dark:"",color:"light-blue darken-3"}},[n("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.dialog=!1}}},[n("v-icon",[e._v("close")])],1),n("v-toolbar-title",[e._v(e._s(-1===e.editingIndex?"New":"Edit")+" Endpoint")]),n("v-spacer"),n("v-toolbar-items",[n("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){e.save()}}},[e._v("Save")])],1)],1),n("v-card-text",{staticStyle:{padding:"0px"}},[n("v-card",{attrs:{flat:""}},[n("v-card-text",[n("v-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{value:!0,outline:"",color:"info",icon:"info"}},[n("strong",[e._v("Endpoint:")]),e._v(" "+e._s(e.loggedUser.sub)+"/"+e._s(e.editingItem.version)+"/"+e._s(e.editingItem.module)+" [GET|POST|PUT|DELETE]\n              ")]),n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs6:""}},[n("v-text-field",{attrs:{rules:e.moduleRules,label:"Name:",placeholder:"",required:"",hint:"Enter the name of the endpoint."},model:{value:e.editingItem.module,callback:function(t){e.$set(e.editingItem,"module",t)},expression:"editingItem.module"}})],1),n("v-flex",{attrs:{xs6:""}},[n("v-text-field",{attrs:{rules:e.versionRules,label:"Version:",placeholder:"e.g: 1.0",required:"",hint:"Enter the version of the endpoint."},model:{value:e.editingItem.version,callback:function(t){e.$set(e.editingItem,"version",t)},expression:"editingItem.version"}})],1)],1),n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs6:""}},[n("v-select",{attrs:{items:["None"],label:"Authentication:"},model:{value:e.editingItem.auth,callback:function(t){e.$set(e.editingItem,"auth",t)},expression:"editingItem.auth"}}),"JWT"===e.editingItem.auth?n("p",{staticStyle:{"margin-top":"-20px",color:"rgba(0,0,0,0.54)","font-size":"12px"}},[e._v("To obtain bearer token, authenticate using POST to "+e._s(e.loggedUser.sub)+"/auth/jwt")]):e._e()],1),n("v-flex",{attrs:{xs6:""}},[n("v-select",{attrs:{items:["None","JSON","HTML","TEXT","JS","XML"],label:"Response Content Type:",hint:"Select response content-type."},model:{value:e.editingItem.header,callback:function(t){e.$set(e.editingItem,"header",t)},expression:"editingItem.header"}})],1)],1),n("h3",[e._v("Source (PHP)")]),n("no-ssr",{attrs:{placeholder:"Loading..."}},[n("codemirror",{attrs:{options:e.cmOption},model:{value:e.editingItem.source,callback:function(t){e.$set(e.editingItem,"source",t)},expression:"editingItem.source"}})],1)],1)],1)],1)],1),n("div",{staticStyle:{flex:"1 1 auto"}})],1)],1)],1)],1)};a._withStripped=!0;var i={render:a,staticRenderFns:[]};t.a=i},F1c2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("teyF"),i=n("31LQ"),r=!1;var s=function(e){r||n("ZphW")},o=n("VU/8")(a.a,i.a,!1,s,null,null);o.options.__file="pages/api/data.vue",t.default=o.exports},"To+1":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".CodeMirror{border:1px solid #eee;height:auto;font-family:Ubuntu Mono,Menlo,Consolas,monospace;font-size:13px;line-height:1.1em}.CodeMirror,.CodeMirror-scroll{min-height:calc(100vh - 350px)}.CodeMirror-gutters{left:0!important}",""])},ZphW:function(e,t,n){var a=n("To+1");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("2a2661e8",a,!1,{sourceMap:!1})},teyF:function(e,t,n){"use strict";var a=n("woOf"),i=n.n(a),r=n("Xxa5"),s=n.n(r),o=n("exGp"),l=n.n(o),c=n("Dd8w"),d=n.n(c),u=n("NYxO"),v=(n("4swq"),n("mtWM")),m=n.n(v);t.a={middleware:["authenticated"],components:{},computed:d()({},Object(u.mapGetters)({isAuthenticated:"auth/isAuthenticated",loggedUser:"auth/loggedUser",loggedToken:"auth/loggedToken"})),data:function(){return{error:"",cmOption:{smartIndent:!1,indentWithTabs:!0,tabSize:4,indentUnit:4,foldGutter:!0,styleActiveLine:!0,lineNumbers:!0,line:!0,keyMap:"sublime",mode:"text/x-php"},snackbar:!1,snackbarColor:"green",snackbarText:"",snackbarTimeout:5e3,items:[],tableHeaders:[{text:"Name",value:"module"},{text:"Version",value:"version"},{text:"Actions",value:"module",sortable:!1,align:"right"}],itemActions:[{title:"Start"},{title:"Stop"},{title:"Delete"}],dialog:!1,editingIndex:-1,editingItem:{id:-1,module:"",version:"1.0",source:"",headers:"",config:null,auth:"None"},defaultItem:{id:-1,module:"",version:"1.0",source:"",headers:"",config:null,auth:"None"},valid:!0,moduleRules:[function(e){return!!e||"Module name is required"},function(e){return e&&e.length<=100||"Module name must be less than 100 characters"}],versionRules:[function(e){return!!e||"Version is required"},function(e){return e&&!isNaN(e)||"Version must be a number"}]}},mounted:function(){var e=this;m.a.defaults.headers.common.Authorization="Bearer "+this.loggedToken,this.$nextTick(function(){e.initialize()})},watch:{dialog:function(e){e||this.close()}},methods:{initialize:function(){var e=l()(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.loggedUser||this.$router.replace("/servers"),e.next=4,m.a.get(this.loggedUser.sub+"/api/ams/data");case 4:t=e.sent,this.items=t.data.data,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.error="Could not fetch data from server.";case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),editItem:function(e){this.editingIndex=this.items.indexOf(e),this.editingItem=i()({},e),this.dialog=!0},deleteItem:function(e){var t=this;this.$prompt.show({persistent:!0,width:400,toolbar:{color:"red darken-3",closable:!1},title:"Delete endpoint?",text:"Are you sure you want to delete the <b>"+e.module+"</b> endpoint?",buttons:[{title:"Yes",color:"success",handler:function(){var n=l()(s.a.mark(function n(){var a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.items.indexOf(e),t.items.splice(a,1),n.prev=2,t.loggedUser||t.$router.replace("/servers"),n.next=6,m.a.delete(t.loggedUser.sub+"/api/ams/data",{data:e});case 6:n.sent,t.snackbar=!0,t.snackbarText="Endpoint successfully deleted.",n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),t.error="Could not delete endpoint from server.";case 14:case"end":return n.stop()}},n,t,[[2,11]])}));return function(){return n.apply(this,arguments)}}()},{title:"No",color:"error"}]})},save:function(){var e=l()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$refs.form.validate()){e.next=15;break}return this.editingIndex>-1?i()(this.items[this.editingIndex],this.editingItem):this.items.push(i()({},this.editingItem)),e.prev=2,this.loggedUser||this.$router.replace("/servers"),e.next=6,m.a.post(this.loggedUser.sub+"/api/ams/data",this.editingItem);case 6:e.sent,this.snackbar=!0,this.snackbarText="Endpoint successfully saved.",e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),this.error="Could not save endpoint to server.";case 14:-1===this.editingIndex&&this.close();case 15:case"end":return e.stop()}},e,this,[[2,11]])}));return function(){return e.apply(this,arguments)}}(),close:function(){var e=this;this.dialog=!1,setTimeout(function(){e.editingItem=i()({},e.defaultItem),e.editingIndex=-1},300)}}}}});